---
# tasks file for DockerBuild
    # - name: Run Docker container
      # shell: |
        # apt update -y install
# /Users/obinna/Desktop/IU/DEVOP/build
   
        
 
    - name: Install Docker
      apt:
        name: docker.io
        state: present
      become: true

    - name: Install Ansible
      apt:
        name: ansible
        state: present
      become: true

   


    - name: Ensure Docker service is running
      service:
        name: docker
        state: started
        enabled: yes
      become: true

    - name: Copy Dockerfile to remote host
      copy:
        src: /Users/obinna/Desktop/IU/DEVOP/Dockerfile
        dest: /home/ubuntu/Dockerfile

    - name: Copy webapp to remote host
      copy:
        src: /Users/obinna/Desktop/IU/DEVOP/webapp
        dest: /home/ubuntu/webapp2
    # - name: Build Docker image
    - name: Build Docker image
      docker_image:
        path: "/home/ubuntu/"  # Directory containing the Dockerfile
        name: "{{docker_image_name}}"            # Name of the Docker image
        tag: "{{docker_image_tag}}"             # Optional: specify a tag
        state: present  

      # community.docker.docker_image:
        # path: "{{ docker_build_context }}"
        # name: "{{ docker_image_name }}"
        # tag: "{{ docker_image_tag }}"
      # become: true
    


      
    - name: Run Docker container
      shell: |
        docker run -d --name {{docker_image_name}} -p 3000:3000 {{ docker_image_name }}:{{ docker_image_tag }}
